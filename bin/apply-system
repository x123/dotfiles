#!env bash
# shellcheck disable=SC2239
set -xeuo pipefail

if which darwin-rebuild
then
  echo "Found darwin-rebuild at $(which darwin-rebuild)"
  pushd ~/.dotfiles || exit
  darwin-rebuild -v switch --flake .#
  popd || exit
elif which nixos-rebuild
then
  echo "Found nixos-rebuild at $(which nixos-rebuild)"
	pushd ~/.dotfiles || exit
	sudo nixos-rebuild -v switch --flake .#
	popd || exit
else
	echo "Error: Could not find nixos-rebuild or darwin-rebuild ... Bailing out!"
	exit 1
fi
